$(document).ready(function(){var n,t,e,a,r,s,i,o,c,l,d,u,f,g,p,m,x,h,k,y,v,B,w,z,A,S,$,b,j;for(n=[["連任比例","第二屆","第三屆","第四屆","第五屆","第六屆","第七屆"],["25~29","-0.55","-0.55","-0.05","0.45","0.45","0.45"],["30~34","-0.35","0.20","0.28","0.01","-0.33","0.20"],["35~39","0.30","0.05","0.14","-0.18","-0.21","-0.12"],["40~44","-0.06","0.05","0.03","0.17","-0.25","0.06"],["45~49","0.02","0.08","-0.09","0.14","-0.15","-0.03"],["50~54","0.11","-0.05","-0.07","0.06","-0.17","0.11"],["55~59","0.02","0.02","-0.10","0.09","-0.18","0.15"],["60~64","0.19","0.00","-0.33","-0.30","-0.22","-0.30"],["65~69","0.00","0.00","0.00","-0.25","0.00","0.00"]],t=[],e=1,a=n.length;a>e;++e)for(r=e,s=1,i=n[0].length;i>s;++s)o=s,t.push({age:n[r][0],session:n[0][o],count:+n[r][o]});return c=[800,600,40],l=c[0],d=c[1],u=c[2],f=d3.select("#svg"),c=["age","session"].map(function(n){return d3.map(t,function(t){return t[n]}).keys()}),g=c[0],p=c[1],m=t.map(function(n){return+n.count||0}),console.log(d3.extent(m)),x=d3.scale.ordinal().domain(p).rangeBands([u,l-u]),h=d3.scale.ordinal().domain(g).rangeBands([d-u-20,u+20]),k=d3.scale.linear().domain(d3.extent(m)).range([0,40]),y=d3.scale.linear().domain(["-1","0","1"]).range([1,0,1]),v=d3.svg.axis().scale(x).tickSize([1]),B=d3.svg.axis().scale(h).orient("left").tickSize([1]),w=x.rangeBand(),z=h.rangeBand(),A=f.append("g"),A.call(v),A.attr({"class":"x-axis",transform:"translate(0,"+(d-u)+")"}),S=f.append("g"),S.call(B),S.attr({"class":"y-axis",transform:"translate(0,0)"}),$=f.selectAll("rect.point").data(t),b=$.enter(),b.append("rect").attr({"class":"point"}),(j=function(){return f.selectAll("rect.point").attr({x:function(n){return x(n.session)},y:function(n){return h(n.age)},width:w,height:z,fill:function(n){return n.count<0?"#f42":"#2f4"},opacity:function(n){return y(n.count)},stroke:"#fff","stroke-width":"3"})})()});